<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Diet - FWG</title>
    <meta name="description" content="A responsive bootstrap 4 admin dashboard template by hence work" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="dist/img/favi.ico">
    <link rel="icon" href="dist/img/favi.ico" type="image/x-icon">

    <!-- Morris Charts CSS -->
    <link href="dist/vendors4/morris.js/morris.css" rel="stylesheet" type="text/css" />

    <!-- Data Table CSS -->
    <link href="dist/vendors4/datatables.net-dt/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
    <link href="dist/vendors4/datatables.net-responsive-dt/css/responsive.dataTables.min.css" rel="stylesheet"
        type="text/css" />

    <!-- Toggles CSS -->
    <link href="dist/vendors4/jquery-toggles/css/toggles.css" rel="stylesheet" type="text/css">
    <link href="dist/vendors4/jquery-toggles/css/themes/toggles-light.css" rel="stylesheet" type="text/css">

    <!-- Toastr CSS -->
    <link href="dist/vendors4/jquery-toast-plugin/dist/jquery.toast.min.css" rel="stylesheet" type="text/css">

    <!-- Pace -->
    <link rel="stylesheet" href="dist/vendors4/pace-progress/themes/blue/pace-theme-minimal.css">

    <!-- Custom CSS -->
    <link href="dist/css/style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="dist/css/fontawesome-free/css/all.min.css">
</head>

<body>
    <!-- HK Wrapper -->
    <div class="hk-wrapper hk-vertical-nav">

       <!-- Top Navbar -->
        <nav class="navbar navbar-expand-xl navbar-light fixed-top hk-navbar py-md-0 py-2" style="flex-wrap: nowrap;">
            <a id="navbar_toggle_btn" class="navbar-toggle-btn nav-link-hover" href="javascript:void(0);"><i
                    class="ion ion-ios-menu"></i></a>
            <a class="navbar-brand d-md-block d-none" href="admin.html">
                <img class="brand-img d-inline-block mr-5" src="dist/img/fitit-logo.png" alt="brand" width="10%" />
            </a>
            <a class="navbar-brand d-md-none d-block" href="admin.html">
                <img class="brand-img d-inline-block mr-5 mt-2" src="dist/img/fitit-logo.png" alt="brand" width="25%" />
            </a>
            <ul class="navbar-nav hk-navbar-content" id="ui_header_profile"></ul>
        </nav>
        <!-- /Top Navbar -->

        <!--Vertical Nav-->
        <div id="navHTML"></div>
        <div id="hk_nav_backdrop" class="hk-nav-backdrop"></div>
        <!--/Vertical Nav-->

        <!-- Main Content -->
        <div class="hk-pg-wrapper">
            <div class="container-fluid">
                <div class="container content-header">
                    <div class="row mt-25 mb-15 align-items-center">
                        <div class="col-md-6">
                            <h1>Diets Details</h1>
                        </div>
                        <div class="col-md-6">
                            <!-- Breadcrumb -->
                            <nav class="hk-breadcrumb" aria-label="breadcrumb">
                                <ol class="breadcrumb bg-transparent float-sm-right mb-0">
                                    <li class="breadcrumb-item"><a href="admin.html">Home</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">Diets</li>
                                </ol>
                            </nav>
                            <!-- /Breadcrumb -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- Container -->
            <div class="container-fluid">
                <!-- Row -->
                <div class="row">
                    <div class="col-xl-12">
                        <!-- Wrapper -->
                        <section class="hk-sec-wrapper">
                            <div class="row">
                                <div class="col-md-12 form-group">
                                    <div class="table-wrap">
                                        <table id="tbl_diet" class="table table-bordered responsive nowrap pb-30 mt-10"
                                            style="width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Diet Plan</th>
                                                    <th>Food Category</th>
                                                    <th>Diet Type</th>
                                                    <th>Day Duration</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr align="center">
                                                    <td colspan="6"><img src="dist/img/loader.gif" style="width:30px">
                                                    </td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Diet Plan</th>
                                                    <th>Food Category</th>
                                                    <th>Diet Type</th>
                                                    <th>Day Duration</th>
                                                    <th>Action</th>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <!-- /Row -->
            </div>
            <!-- /Container -->


        </div>
        <!-- /Main Content -->

    </div>
    <!-- /HK Wrapper -->

    <!-- jQuery -->
    <script src="dist/vendors4/jquery/dist/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="dist/vendors4/popper.js/dist/umd/popper.min.js"></script>
    <script src="dist/vendors4/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Slimscroll JavaScript -->
    <script src="dist/js/jquery.slimscroll.js"></script>

    <!-- Fancy Dropdown JS -->
    <script src="dist/js/dropdown-bootstrap-extended.js"></script>

    <!-- FeatherIcons JavaScript -->
    <script src="dist/js/feather.min.js"></script>

    <!-- Toggles JavaScript -->
    <script src="dist/vendors4/jquery-toggles/toggles.min.js"></script>
    <script src="dist/js/toggle-data.js"></script>

    <!-- Toastr JS -->
    <script src="dist/vendors4/jquery-toast-plugin/dist/jquery.toast.min.js"></script>

    <!-- Counter Animation JavaScript -->
    <script src="dist/vendors4/waypoints/lib/jquery.waypoints.min.js"></script>
    <script src="dist/vendors4/jquery.counterup/jquery.counterup.min.js"></script>

    <!-- Data Table JavaScript -->
    <script src="dist/vendors4/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="dist/vendors4/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="dist/vendors4/datatables.net-dt/js/dataTables.dataTables.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/buttons.flash.min.js"></script>
    <script src="dist/vendors4/jszip/dist/jszip.min.js"></script>
    <script src="dist/vendors4/pdfmake/build/pdfmake.min.js"></script>
    <script src="dist/vendors4/pdfmake/build/vfs_fonts.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="dist/vendors4/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="dist/js/dataTables-data.js"></script>
    <link rel="stylesheet" href="dist/vendors4/datatables.net-bs4/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="dist/vendors4/Responsive-2.3.0/css/responsive.bootstrap.min.css">
    <!-- Morris Charts JavaScript -->
    <script src="dist/vendors4/raphael/raphael.min.js"></script>
    <script src="dist/vendors4/morris.js/morris.min.js"></script>

    <!-- Easy pie chart JS -->
    <script src="dist/vendors4/easy-pie-chart/dist/jquery.easypiechart.min.js"></script>

    <!-- Sweet-alert -->
    <script src="dist/sweetalert2.js"></script>

    <!-- EChartJS JavaScript -->
    <script src="dist/vendors4/echarts/dist/echarts-en.min.js"></script>

    <!-- Init JavaScript -->
    <script src="dist/js/init.js"></script>
    <script src="dist/js/dashboard2-data.js"></script>

    <!-- Pace -->
    <script src="dist/vendors4/pace-progress/pace.min.js"></script>

    <!-- Custom js -->
    <script src="dist/app.js"></script>
    <script src="dist/menu-items.js"></script>

    <!-- Authorization -->
    <script src="dist/authorization.js"></script>
</body>
<script>
    var tblDiet = $('#tbl_diet').DataTable({
        destroy: true,
        responsive: true,
        lengthMenu: [10, 25, 50, 75, 100, 200, 500, 800, 1000],
        pageLength: 100,
        language: {
            search: "_INPUT_",
            searchPlaceholder: "Search...",
            "sLengthMenu": "Show _MENU_ Records",
        },
        "dom": '<"row"<"#idid.col-7"><"col-5"fl><"col-12"rt><"col-12">><"row"<"col-12"ip>><"clear">',
        "columns": [{
            "width": "1%"
        }, {
            "width": "20%"
        }, {
            "width": "10%"
        }, {
            "width": "10%"
        }, {
            "width": "10%"
        }, {
            "width": "20%"
        }]
    });
    // Add content to col-7
    $('#idid').html(
        '<div class="">' +
        `<button id="btn_create" class="btn text-white mb-2" style="background-color: #0854ff;" onclick="window.location.href='diet-plan-details.html?menu_item=menu_diet'"><i class="fa fa-plus"></i> Create </button>` +
        '</div>');


    $(document).ready(() => {
        getAllDiet()
    })

    // Get Diets
    let allDiet;

    function getAllDiet() {
        // get access list from local storage
        const accessList = JSON.parse(localStorage.getItem('access_list'));
        const type = JSON.parse(localStorage.getItem('type'));

        $.getJSON(`${BASE_URL}/diet-plan/get-diet-plan`).then(result => {
            allDiet = result.data
            let {
                data
            } = result
            tblDiet.clear().draw();
            var tableRow = []
            data.forEach((tempDiet, index) => {

                let food_category = 'N/A'
                if (tempDiet.category_name) {
                    food_category = tempDiet.category_name || 'N/A'
                }

                if (tempDiet.food_type) {
                    food_type = tempDiet.food_type || 'N/A'
                }

                var actionHTML = "";

                actionHTML += `<button type="button" class="btn btn-primary m-1" onclick="window.location.href='diet-plan-details.html?menu_item=diet_plan&diet_plan_id=${tempDiet._id}'" title="Diet Configuration"><i class="fas fa-pencil-alt"></i>&nbsp;Edit</button>`
                $("#btn_create").show();
                // actionHTML += `<button type="button" class="btn btn-success m-1" onclick=downloadDietPlan("${tempDiet._id}",this)><i class="fas fa-file-download m1-2"></i> PDF</button>`;
                actionHTML += `<button type="button" class="btn btn-danger m-1" onclick=removeDietPlan("${tempDiet._id}",this)><i class="fa fa-trash"></i></button>`;

                tableRow.push([index + 1, tempDiet.plan_name, food_category, food_type, tempDiet.days, actionHTML])
            });

            tblDiet.rows.add(tableRow).draw()

        }).fail(error => {
            return error.responseJSON ? toastError('Error', error.responseJSON.message) : toastError();
        })
    }


    // Remove Diet Plan
    function removeDietPlan(id, element) {
        Swal.fire({
            title: 'Are you sure?',
            text: "This action can not be undo",
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: 'Remove'
        }).then((result) => {
            if (result.value) {
                $.post({
                    url: BASE_URL + '/diet-plan/remove-diet-plan',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        id
                    }),
                    success: (result) => {
                        toastSuccess('Success', 'Diet item removed successfully')
                    },
                    error: (error) => {
                        $(element).removeAttr('disabled');
                        return error.responseJSON ? toastError('Error', error.responseJSON.message) : toastError();
                    },
                    beforeSend: () => {
                        $(element).attr('disabled', true)
                    },
                    complete: () => {
                        $(element).removeAttr('disabled')
                        return getAllDiet()
                    }
                });
            }
        });
    }
</script>

</html>