<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Clients - FITIT</title>
    <meta name="description" content="A responsive bootstrap 4 admin dashboard template by hencework" />

    <!-- Favicon -->
    <link rel="shortcut icon" href="dist/img/favi.ico">
    <link rel="icon" href="dist/img/favi.ico" type="image/x-icon">

    <!-- Morris Charts CSS -->
    <link href="dist/vendors4/morris.js/morris.css" rel="stylesheet" type="text/css" />

    <!-- Toggles CSS -->
    <link href="dist/vendors4/jquery-toggles/css/toggles.css" rel="stylesheet" type="text/css">
    <link href="dist/vendors4/jquery-toggles/css/themes/toggles-light.css" rel="stylesheet" type="text/css">

    <!-- Toastr CSS -->
    <link href="dist/vendors4/jquery-toast-plugin/dist/jquery.toast.min.css" rel="stylesheet" type="text/css">

    <!-- Pace -->
    <link rel="stylesheet" href="dist/vendors4/pace-progress/themes/blue/pace-theme-minimal.css">

    <!-- Custom CSS -->
    <link href="dist/css/style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="dist/css/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="dist/vendors4/daterangepicker/daterangepicker.css">
</head>

<body>
    <!-- HK Wrapper -->
    <div class="hk-wrapper hk-vertical-nav">

       <!-- Top Navbar -->
        <nav class="navbar navbar-expand-xl navbar-light fixed-top hk-navbar py-md-0 py-2" style="flex-wrap: nowrap;">
            <a id="navbar_toggle_btn" class="navbar-toggle-btn nav-link-hover" href="javascript:void(0);"><i
                    class="ion ion-ios-menu"></i></a>
            <a class="navbar-brand d-md-block d-none" href="admin.html">
                <img class="brand-img d-inline-block mr-5" src="dist/img/fitit-logo.png" alt="brand" width="10%" />
            </a>
            <a class="navbar-brand d-md-none d-block" href="admin.html">
                <img class="brand-img d-inline-block mr-5 mt-2" src="dist/img/fitit-logo.png" alt="brand" width="25%" />
            </a>
            <ul class="navbar-nav hk-navbar-content" id="ui_header_profile"></ul>
        </nav>
        <!-- /Top Navbar -->

        <!--Vertical Nav-->
        <div id="navHTML"></div>
        <div id="hk_nav_backdrop" class="hk-nav-backdrop"></div>
        <!--/Vertical Nav-->

        <!-- Main Content -->
        <div class="hk-pg-wrapper">
            <div class="container-fluid">
                <div class="container content-header">
                    <div class="row mt-35 mb-15 align-items-center">
                        <div class="col-md-6">
                            <h1>Lead Details</h1>
                        </div>
                        <div class="col-md-6">
                            <!-- Breadcrumb -->
                            <nav class="hk-breadcrumb" aria-label="breadcrumb">
                                <ol class="breadcrumb bg-transparent float-sm-right mb-0">
                                    <li class="breadcrumb-item"><a href="admin.html">Home</a></li>
                                    <li class="breadcrumb-item active" aria-current="page">Lead</li>
                                </ol>
                            </nav>
                            <!-- /Breadcrumb -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- Container -->
            <div class="container-fluid">
                <!-- Row -->
                <div class="row">
                    <div class="col-xl-12">
                        <!-- Wrapper -->
                        <section class="hk-sec-wrapper">
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn-outline-primary btn" onclick="addLeadData()"
                                        style="font-size: 16px;"><i class="far fa-plus-square"></i> Add
                                        Lead</button>
                                    <a href="https://gcsconsultant.com/pdf/gcs_data.xlsx" class="btn-outline-info btn">
                                        <i class="fas fa-download"></i> Download Excel
                                    </a>
                                    <button id="uploadExcelBtn" onclick="uploadLeadFile()"
                                        class="btn-outline-success btn mt-3 mt-md-0" style="font-size: 16px;"><i
                                            class="fas fa-upload"></i> Upload Excel File</button>
                                </div>
                                <div class="col-md-6">
                                    <div class="row justify-content-end">
                                        <div class="mr-3">
                                            <div id="reportrange" class="mt-3 mt-md-0"
                                                style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%">
                                                <i class="fa fa-calendar"></i>&nbsp;
                                                <span></span> <i class="fa fa-caret-down"></i>
                                            </div>
                                        </div>
                                        <div class="px-1 mt-3 mt-md-0">
                                            <select id="filterOptionPlan" style="padding: 6px;">
                                                <option value="all_data">All data</option>
                                                <option value="Not Interested" style="color: red;"> Not Interested
                                                </option>
                                                <option value="Potential" style="color: goldenrod;"> Potential </option>
                                                <option value="Interested" style="color: green;"> Interested </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-12">
                                    <div>
                                        <table id="tbl_lead_user"
                                            class="mt-10 table table-bordered responsive nowrap display pb-30"
                                            style="width: 100%;">
                                            <thead>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Full Name</th>
                                                    <th>Service</th>
                                                    <th>Type</th>
                                                    <th>Date</th>
                                                    <th>Mobile</th>
                                                    <th>Reference</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr align="center">
                                                    <td colspan="6"><img src="dist/img/loader.gif" style="width:30px">
                                                    </td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                    <td hidden></td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <th>No.</th>
                                                    <th>Full Name</th>
                                                    <th>Service</th>
                                                    <th>Type</th>
                                                    <th>Date</th>
                                                    <th>Mobile</th>
                                                    <th>Reference</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <!-- /Row -->
            </div>
            <!-- /Container -->

            <!-- Footer -->
            <div class="hk-footer-wrap container">
                <footer class="footer">
                    <div class="row">
                        <div class="col-md-12 col-sm-12">
                            <p>Design and Developed by
                                <a href="https://gcsconsultant.com/digital-marketing-agency.html" target="_blank">Fitit
                                    Offical</a>
                            </p>
                        </div>

                    </div>
                </footer>
            </div>
            <!-- /Footer -->
        </div>
        <!-- /Main Content -->

    </div>
    <!-- /HK Wrapper -->

    <!-- Modal -->
    <div class="modal fade" id="modal_lead" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Add Lead</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="col-md-12 mt-20">
                        <div class="row mb-3">
                            <div class="col form-outline">
                                <label for="txt_name">Full Name :</label>
                                <input type="text" class="form-control" id="txt_name" placeholder="Enter Name">
                            </div>
                            <div class="col form-outline">
                                <label for="txt_date">Date :</label>
                                <input type="date" class="form-control" id="txt_date">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col form-outline">
                                <label>Client Type :-</label><br>
                                <select class="form-control" id="list_client_type" required="">
                                    <option value="" hidden="">Select Service</option>
                                    <option value="Not Interested" style="color: red;"> Not Interested </option>
                                    <option value="Potential" style="color: goldenrod;"> Potential </option>
                                    <option value="Interested" style="color: green;"> Interested </option>
                                </select>
                            </div>
                            <div class="col form-outline">
                                <label>Service :-</label><br>
                                <input type="text" class="form-control" id="txt_service"
                                    placeholder="Enter Service Name">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="txt_mobile">Mobile no.:</label>
                                <input type="text" class="form-control" id="txt_mobile"
                                    placeholder="Enter Mobile Number">
                            </div>
                            <div class="col">
                                <label for="txt_email">Email :-</label>
                                <input type="text" class="form-control" id="txt_email" placeholder="Enter Email">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="txt_place">Place :-</label>
                                <input type="text" class="form-control" id="txt_place"
                                    placeholder="Enter Place/Area of Meeting">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <label for="txt_reference">Reference :-</label>
                                <input type="text" class="form-control" id="txt_reference"
                                    placeholder="Enter Reference">
                            </div>
                            <div class="col">
                                <label for="txt_note">Notes :-</label>
                                <input type="text" class="form-control" id="txt_note" placeholder="Enter Notes">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div id="div_modal_button">
                        <button class="btn btn-success" id="add_lead"><i class="fas fa-link"></i> Add
                            Lead</button>
                        <button class="btn btn-success" id="update_lead" style="display: none;"><i
                                class="fas fa-link"></i> Update
                            Lead</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="modal_lead_file" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Add Lead Excel File</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <label for="">Upload Excel File</label>
                    <input type="file" name="file" id="file_upload">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Close</button>
                    <button type="button" id="add_lead_file" class="btn btn-primary">Upload</button>
                </div>
            </div>
        </div>
    </div>
    <p id="hidden_lead_id" hidden></p>
    <!-- jQuery -->
    <script src="dist/vendors4/jquery/dist/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="dist/vendors4/popper.js/dist/umd/popper.min.js"></script>
    <script src="dist/vendors4/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Slimscroll JavaScript -->
    <script src="dist/js/jquery.slimscroll.js"></script>

    <!-- Fancy Dropdown JS -->
    <script src="dist/js/dropdown-bootstrap-extended.js"></script>

    <!-- FeatherIcons JavaScript -->
    <script src="dist/js/feather.min.js"></script>

    <!-- Toggles JavaScript -->
    <script src="dist/vendors4/jquery-toggles/toggles.min.js"></script>
    <script src="dist/js/toggle-data.js"></script>

    <!-- Toastr JS -->
    <script src="dist/vendors4/jquery-toast-plugin/dist/jquery.toast.min.js"></script>
    <script src="dist/js/toast-data.js"></script>

    <!-- Data Table JavaScript -->
    <script src="dist/vendors4/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="dist/vendors4/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="dist/vendors4/datatables.net-dt/js/dataTables.dataTables.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/buttons.flash.min.js"></script>
    <script src="dist/vendors4/jszip/dist/jszip.min.js"></script>
    <script src="dist/vendors4/pdfmake/build/pdfmake.min.js"></script>
    <script src="dist/vendors4/pdfmake/build/vfs_fonts.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="dist/vendors4/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="dist/vendors4/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="dist/js/dataTables-data.js"></script>
    <link rel="stylesheet" href="dist/vendors4/datatables.net-bs4/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="dist/vendors4/Responsive-2.3.0/css/responsive.bootstrap.min.css">
    <!-- Counter Animation JavaScript -->
    <script src="dist/vendors4/waypoints/lib/jquery.waypoints.min.js"></script>
    <script src="dist/vendors4/jquery.counterup/jquery.counterup.min.js"></script>

    <!-- Select2 JavaScript -->
    <script src="dist/vendors4/select2/dist/js/select2.full.min.js"></script>
    <!-- <script src="dist/js/select2-data.js"></script> -->

    <!-- Morris Charts JavaScript -->
    <script src="dist/vendors4/raphael/raphael.min.js"></script>
    <script src="dist/vendors4/morris.js/morris.min.js"></script>

    <!-- Easy pie chart JS -->
    <script src="dist/vendors4/easy-pie-chart/dist/jquery.easypiechart.min.js"></script>

    <!-- Apex JavaScript -->
    <script src="dist/vendors4/apexcharts/dist/apexcharts.min.js"></script>

    <!-- EChartJS JavaScript -->
    <script src="dist/vendors4/echarts/dist/echarts-en.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Init JavaScript -->
    <script src="dist/js/init.js"></script>
    <script src="dist/js/dashboard2-data.js"></script>

    <!-- Sweet-alert -->
    <script src="dist/sweetalert2.js"></script>

    <!-- Pace -->
    <script src="dist/vendors4/pace-progress/pace.min.js"></script>

    <!--Nestable js -->
    <script src="dist/vendors4/nestable2/dist/jquery.nestable.min.js"></script>

    <!-- Custom Script -->
    <script src="dist/app.js"></script>
    <script src="dist/menu-items.js"></script>

    <!-- Authorization -->
    <script src="dist/authorization.js"></script>

    <!-- DatePiker -->
    <script src="dist/vendors4/moment/min/moment.min.js"></script>
    <script src="dist/vendors4/daterangepicker/daterangepicker.js"></script>
</body>
<script>
    // Apply filters based on URL parameters
    $(document).ready(() => {
        const urlParams = new URLSearchParams(window.location.search);
        const filterOptionPlanParam = urlParams.get('filterOptionPlan');

        const defaultFilterOptionPlan = filterOptionPlanParam || 'all_data';

        $('#filterOptionPlan').val(defaultFilterOptionPlan);

        applyFilterPlan(defaultFilterOptionPlan);

        // Bind the applyFilterPlan function to the "filterOptionPlan" dropdown's change event
        $("#filterOptionPlan").on("change", function () {
            const selectedFilterPlan = $(this).val();
            applyFilterPlan(selectedFilterPlan);
            updateUrlParam(selectedFilterPlan);
        });

        $("#tbl_lead_user").on("keyup", function () {
            tblLead.search(this.value).draw();
        });
    });

    let tblLead = $('#tbl_lead_user').DataTable({
        destroy: true,
        responsive: true,
        lengthMenu: [10, 25, 50, 75, 100, 200, 500, 800, 1000],
        pageLength: 10,
        paging: true, // Disable pagination
        searching: true,
        language: {
            search: "_INPUT_",
            searchPlaceholder: "Search...",
            "sLengthMenu": "Show _MENU_ Records",
        },
        "dom": '<"row"<"col-10"l><"col-2"f><"col-12"rt><"col-12">><"row"<"col-9"i><"col-3"p>><"clear">',
        columns: [
            { width: "1%" },
            { width: "10%" },
            { width: "6%" },
            { width: "6%" },
            { width: "8%" },
            { width: "8%" },
            { width: "10%" },
            { width: "16%" },
        ],
    });

    // Initialize date range picker and apply the initial date filter
    $('#reportrange').daterangepicker({
        startDate: moment().subtract(29, 'days'),
        endDate: moment(),
        ranges: {
            'Today': [moment(), moment()],
            'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
            'Last 7 Days': [moment().subtract(6, 'days'), moment()],
            'Last 30 Days': [moment().subtract(29, 'days'), moment()],
            'This Month': [moment().startOf('month'), moment().endOf('month')],
            'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
            'Lifetime': [moment('2000-01-01'), moment()]
        }
    }, applyDateFilter);
    applyDateFilter();

    $(document).ready(() => {
        getLeadDetails()
    });

    function uploadLeadFile() {
        $('#modal_lead_file').modal('show');
    }

    $("#add_lead_file").click(function () {
        var formData = new FormData();
        var fileInput = document.getElementById('file_upload');
        formData.append('file', fileInput.files[0]);

        $.post({
            url: BASE_URL + '/lead/upload-lead',
            data: formData,
            processData: false,
            contentType: false,
            success: function (result) {
                $('#modal_lead_file').modal('hide');
                swal.fire({
                    title: 'Successful',
                    text: 'File Uploaded successfully',
                    icon: 'success',
                });
                $('#file_upload').val('');
                getLeadDetails();
            },
            error: (error) => {
                return error.responseJSON ? toastError('Error', error.responseJSON.message) : toastError();
            },
            beforeSend: function () {
                $('#add_lead_file').attr('disabled', true);
            },
            complete: function () {
                $('#add_lead_file').removeAttr('disabled');
            }
        });
    });


    function getLeadDetails() {
        $.get({
            url: BASE_URL + `/lead/get-lead`,
            success: (result) => {
                var result = result.data;
                tblLead.clear().draw();
                let leadIndex = 1;
                if (result) {
                    let tableRow = [];

                    for (var i = 0; i < result.length; i++) {
                        var tempUser = result[i];
                        const startDate = $('#reportrange').data('daterangepicker').startDate;
                        const endDate = $('#reportrange').data('daterangepicker').endDate;
                        const leadDate = moment(tempUser.date, 'YYYY-MM-DD');
                        const action = `<div class="d-flex mt-2">
                                    <button type="button" class="btn mr-1 btn-outline-success px-2 py-1" onclick=updateLeadData("${tempUser._id}",this)><i class="fas fa-user-edit"></i> Update</button>
                                    <button type="button" class="btn mr-1 btn-outline-danger px-2 py-1" onclick=removeLeadData("${tempUser._id}",this)><i class="fas fa-trash"></i> Remove</button></div>`
                        try {
                            if (leadDate.isBetween(startDate, endDate, null, '[]')) {
                                tblLead.row.add([
                                    leadIndex,
                                    `${tempUser.fullName || 'N/A'}`,
                                    `${tempUser.service || 'N/A'}`,
                                    tempUser.leadType || "N/A",
                                    tempUser.date,
                                    tempUser.phoneNumber || "N/A",
                                    tempUser.reference || "N/A",
                                    action
                                ]).draw();
                                leadIndex++;
                            }
                        } catch (error) {
                            console.error('Error in isBetween condition:', error);
                        }
                    }
                }
            },
            error: (error) => {
                return error.responseJSON ? toastError('Error', error.responseJSON.message) : toastError();
            }
        });
    }


    function applyDateFilter(start, end) {
        const startDate = start || moment().subtract(29, 'days');
        const endDate = end || moment();
        $('#reportrange span').html(startDate.format('MMMM D, YYYY') + ' - ' + endDate.format('MMMM D, YYYY'));

        getLeadDetails();
    }

    function applyFilterPlan(filterPlan) {
        tblLead.columns().visible(true);

        if (filterPlan !== "all_data") {
            tblLead.columns(3).search(filterPlan).draw();
        } else {
            // Clear all filters and redraw the table
            tblLead.columns(3).search("").draw();
        }
    }


    function addLeadData() {
        resetInputFields();
        $('#add_lead').show();
        $('#update_lead').hide();
        $('.modal-title').text('Add Lead');
        $('#modal_lead').modal('show');
    }

    function updateLeadData(id) {
        $.get({
            url: BASE_URL + '/lead/get-lead?id=' + id,
            success: (result) => {
                const leadDetailsArray = result.data;

                // Find the lead with the specified id in the array
                const leadDetails = leadDetailsArray.find(lead => lead._id === id);
                console.log(leadDetails)
                // Check if leadDetails is not undefined
                if (leadDetails) {
                    $("#txt_Date").val(leadDetails.date);
                    $("#txt_name").val(leadDetails.fullName);
                    $("#txt_email").val(leadDetails.email);
                    $("#txt_mobile").val(leadDetails.phoneNumber);
                    $("#txt_service").val(leadDetails.service);
                    $("#list_client_type").val(leadDetails.leadType);
                    $("#txt_place").val(leadDetails.leadAddress);
                    $("#txt_reference").val(leadDetails.reference);
                    $("#txt_note").val(leadDetails.leadNotes); // Use leadNotes instead of notes

                    $('#hidden_lead_id').val(leadDetails._id);

                    $('#add_lead').hide();
                    $('#update_lead').show();
                    $('.modal-title').text('Update Lead');

                    // Show the modal
                    $('#modal_lead').modal('show');
                } else {
                    toastError('Error', 'Lead details not found.');
                }
            },
            error: (error) => {
                const errorMessage = error.responseJSON ? error.responseJSON.message : 'Error';
                toastError('Error', errorMessage);
            }
        });
    }



    $("#add_lead").click(async () => {
        var date = $("#txt_date").val();
        var fullName = $("#txt_name").val();
        var email = $("#txt_email").val();
        var phoneNumber = $("#txt_mobile").val();
        var service = $("#txt_service").val();
        var leadType = $("#list_client_type").val();
        var leadAddress = $("#txt_place").val();
        var reference = $("#txt_reference").val();
        var notes = $("#txt_note").val();
        // Check for required fields
        if (!date || !fullName || !phoneNumber || !email || !service || !leadType || !leadAddress || !reference) {
            return swal.fire({
                title: 'Error!',
                text: 'All Fields Required',
                icon: 'error',
            });
        }

        var bodyObject = {
            fullName: fullName,
            service: service,
            leadType: leadType,
            date: date,
            phoneNumber: phoneNumber,
            email: email,
            leadAddress: leadAddress,
            reference: reference,
            leadNotes: notes,
        };
        $.ajax({
            url: BASE_URL + `/lead/create-lead`,
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(bodyObject),
            success: function (result) {
                result = result.data;
                $('#modal_lead').modal('hide');
                swal.fire({
                    title: 'Successful',
                    text: 'Lead Add successfully',
                    icon: 'success',
                });
                getLeadDetails();
            },
            error: (error) => {
                return error.responseJSON ? toastError('Error', error.responseJSON.message) : toastError();
            },
            beforeSend: function () {
                $('#add_lead').attr('disabled', true);
            },
            complete: function () {
                $('#add_lead').removeAttr('disabled');
            }
        });
    });

    $("#update_lead").click(async () => {
        var date = $("#txt_date").val();
        var fullName = $("#txt_name").val();
        var email = $("#txt_email").val();
        var phoneNumber = $("#txt_mobile").val();
        var service = $("#txt_service").val();
        var leadType = $("#list_client_type").val();
        var leadAddress = $("#txt_place").val();
        var reference = $("#txt_reference").val();
        var notes = $("#txt_note").val();
        var id = $('#hidden_lead_id').val();
        var bodyObject = {
            id: id,
            fullName: fullName,
            service: service,
            leadType: leadType,
            date: date,
            phoneNumber: phoneNumber,
            email: email,
            leadAddress: leadAddress,
            reference: reference,
            leadNotes: notes,
        };
        $.ajax({
            url: BASE_URL + `/lead/update-lead`,
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(bodyObject),
            success: function (result) {
                result = result.data;
                $('#modal_lead').modal('hide');
                swal.fire({
                    title: 'Successful',
                    text: 'Lead Update successfully',
                    icon: 'success',
                });
                $('#lead_form')[0].reset()
                getLeadDetails();
            },
            error: (error) => {
                return error.responseJSON ? toastError('Error', error.responseJSON.message) : toastError();
            },
            beforeSend: function () {
                $('#update_lead').attr('disabled', true);
            },
            complete: function () {
                $('#update_lead').removeAttr('disabled');
            }
        });
    });

    function removeLeadData(id) {
        var bodyObject = {
            id: id
        };
        console.log(bodyObject)
        Swal.fire({
            title: 'Are you sure?',
            text: 'You are about to remove this Lead Data.',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, remove it!',
        }).then((result) => {
            if (result.isConfirmed) {
                $.post({
                    url: BASE_URL + `/lead/remove-lead`,
                    contentType: 'application/json',
                    data: JSON.stringify(bodyObject),
                    success: function (response) {
                        getLeadDetails();
                        Swal.fire('Removed!', 'The Lead has been removed.', 'success');
                    },
                    error: function (error) {
                        var errorMessage = error.responseJSON ? error.responseJSON.message : 'Error';
                        Swal.fire('Error!', errorMessage, 'error');
                    }
                });
            }
        });
    }

    applyFilterPlan()

    function updateUrlParam(filterPlan) {
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set('filterOptionPlan', filterPlan);
        const newUrl = window.location.pathname + '?' + urlParams.toString();
        history.pushState(null, '', newUrl);
    }

    function resetInputFields() {
        $("#txt_Date").val('');
        $("#txt_name").val('');
        $("#txt_email").val('');
        $("#txt_mobile").val('');
        $("#txt_service").val('');
        $("#list_client_type").val('');
        $("#txt_place").val('');
        $("#txt_reference").val('');
        $("#txt_note").val('');
        $('#hidden_lead_id').val('');
    }
</script>

</html>